{"remainingRequest":"/Users/shenxh/Desktop/qa_auto_test/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/shenxh/Desktop/qa_auto_test/src/components/testplan/historyplan.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/shenxh/Desktop/qa_auto_test/src/components/testplan/historyplan.vue","mtime":1611912960092},{"path":"/Users/shenxh/Desktop/qa_auto_test/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/shenxh/Desktop/qa_auto_test/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/shenxh/Desktop/qa_auto_test/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/shenxh/Desktop/qa_auto_test/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCByZXF1ZXN0IGZyb20gIkAvdXRpbHMvcmVxdWVzdCI7CmltcG9ydCB7IG1lc3NhZ2UsIE1vZGFsIH0gZnJvbSAiYW50LWRlc2lnbi12dWUiOwppbXBvcnQgaWNvbmZvbnQgZnJvbSAiQC9jb21wb25lbnRzL21vZHVsZWxpc3QvaWNvbmZvbnQiOwppbXBvcnQgZWFjaGhpc3RvcnlwbGFuIGZyb20gIkAvY29tcG9uZW50cy90ZXN0cGxhbi9lYWNoaGlzdG9yeXBsYW4iOwoKZXhwb3J0IGRlZmF1bHQgewogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBsb2FkaW5nOiBmYWxzZSwKICAgICAgbG9hZGluZ01vcmU6IGZhbHNlLAogICAgICBzaG93TG9hZGluZ01vcmU6IHRydWUsCiAgICAgIGRhdGE6IFtdLAogICAgICBiYXNlVXJsOiAiL2FwaS9wbGFuL2hpc3RvcnlwbGFuP3BhZ2VpZD0iLAogICAgICBwYWdlSW5kZXg6IDEsCiAgICAgIHNob3dQbGFuTGlzdDogdHJ1ZSwKICAgICAgc2hvd0VhY2hQbGFuOiBmYWxzZQogICAgfTsKICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmdldFBsYW5EYXRhKCk7CiAgfSwKICB3YXRjaDoge30sCiAgY29tcG9uZW50czogewogICAgaWNvbmZvbnQsCiAgICBlYWNoaGlzdG9yeXBsYW4KICB9LAogIG1ldGhvZHM6IHsKICAgIGdldFBsYW5EYXRhKCkgewogICAgICB0aGlzLmxvYWRpbmdNb3JlID0gdHJ1ZTsKICAgICAgY29uc3QgdG90YWxfcmVxID0gdGhpcy5iYXNlVXJsICsgdGhpcy5wYWdlSW5kZXg7CiAgICAgIHJlcXVlc3QoewogICAgICAgIHVybDogdG90YWxfcmVxLAogICAgICAgIG1ldGhvZDogIkdFVCIKICAgICAgfSkudGhlbihyZXMgPT4gewogICAgICAgIGlmIChyZXMuZGF0YS5jb2RlID09PSAzNDAwMDApIHsKICAgICAgICAgIHRoaXMuZGF0YSA9IFsuLi50aGlzLmRhdGEsIC4uLnJlcy5kYXRhLmRhdGEuZGF0YV07CiAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmRhdGEpOwogICAgICAgICAgaWYgKHRoaXMucGFnZUluZGV4ID49IHJlcy5kYXRhLmRhdGEudG90b2xQYWdlKSB7CiAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmdNb3JlID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG1lc3NhZ2Uud2FybmluZyhyZXMuZGF0YS5tc2cpOwogICAgICAgIH0KICAgICAgICB0aGlzLnBhZ2VJbmRleCArPSAxOwogICAgICAgIHRoaXMubG9hZGluZ01vcmUgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9LAoKICAgIHBsYW5EZXRhaWxDb250ZW50KHJlY29yZCkgewogICAgICByZXR1cm4gKAogICAgICAgICLmjqXlj6Popobnm5bnjofvvJoiICsgcmVjb3JkLmNvcmVSYXRlICsgIu+8m+iuoeWIkuWIm+W7uuS6uu+8miIgKyByZWNvcmQucGxhblVzZXIKICAgICAgKTsKICAgICAgLy8gICByZXR1cm4gIuW8gOWni+aXtumXtO+8miIgKyByZWNvcmQucGxhblN0YXJ0ICsgIu+8m+e7k+adn+aXtumXtO+8miIrIHJlY29yZC5wbGFuRW5kICsgIu+8m+imhueblueOh++8miIgKyByZWNvcmQuY29yZVJhdGU7CiAgICB9LAoKICAgIGhhbmRsZURlbGV0ZU9rKHJlY29yZCkgewogICAgICBjb25zb2xlLmxvZyhyZWNvcmQpOwogICAgICByZXF1ZXN0KHsKICAgICAgICB1cmw6ICIvYXBpL3BsYW4vZGVsZXRlaGlzdG9yeXBsYW4iLAogICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgIGRhdGE6IHsgaWQ6IHJlY29yZC5pZCB9CiAgICAgIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICBpZiAocmVzLmRhdGEuY29kZSA9PT0gMzUwMDAwKSB7CiAgICAgICAgICBtZXNzYWdlLnN1Y2Nlc3MocmVzLmRhdGEubXNnKTsKICAgICAgICAgIC8qKgogICAgICAgICAgICog5Yig6Zmk5oiQ5Yqf5ZCO77yM5bCG5pWw5o2u6YeN572uCiAgICAgICAgICAgKi8KICAgICAgICAgIHRoaXMucGFnZUluZGV4ID0gMTsKICAgICAgICAgIHRoaXMuZGF0YSA9IFtdOwogICAgICAgICAgdGhpcy5zaG93TG9hZGluZ01vcmUgPSB0cnVlOwogICAgICAgICAgdGhpcy5nZXRQbGFuRGF0YSgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBtZXNzYWdlLndhcm5pbmcocmVzLmRhdGEubXNnKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIHNob3dEZWxldGVDb25maXJtKHJlY29yZCkgewogICAgICB0aGlzLnNlbGVjdENvcmVEYXRhID0gcmVjb3JkOwogICAgICBjb25zdCB0aGF0ID0gdGhpczsKICAgICAgTW9kYWwuY29uZmlybSh7CiAgICAgICAgdGl0bGU6ICLnoa7orqTopoHliKDpmaTmraTmjqXlj6PkuYjvvJ8o5Yig6Zmk5LmL5ZCO5LiN5Y+v5oGi5aSNKSIsCiAgICAgICAgY29udGVudDoKICAgICAgICAgICLniYjmnKw6ICIgKyByZWNvcmQuY2xpZW50VmVyc2lvbiArICI7IOWIm+W7uuS6ujogIiArIHJlY29yZC5wbGFuVXNlciwKICAgICAgICBva1RleHQ6ICLnoa7orqQiLAogICAgICAgIG9rVHlwZTogImRhbmdlciIsCiAgICAgICAgY2FuY2VsVGV4dDogIuWPlua2iCIsCiAgICAgICAgb25PaygpIHsKICAgICAgICAgIHRoYXQuaGFuZGxlRGVsZXRlT2socmVjb3JkKTsKICAgICAgICB9LAogICAgICAgIG9uQ2FuY2VsKCkgewogICAgICAgICAgY29uc29sZS5sb2coIkNhbmNlbCIpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgY2xpY2tQbGFuRGV0YWlsKHJlY29yZCkgewogICAgICBjb25zb2xlLmxvZyhyZWNvcmQuaWQpOwogICAgICB0aGlzLiRyZWZzLmVhY2hoaXN0b3J5cGxhbi5nZXRQbGFuSWQocmVjb3JkKTsKICAgICAgdGhpcy5zaG93UGxhbkxpc3QgPSBmYWxzZTsKICAgICAgdGhpcy5zaG93RWFjaFBsYW4gPSB0cnVlOwogICAgfSwKICAgIHJlU2hvd1BsYW5MaXN0KCkgewogICAgICB0aGlzLnNob3dFYWNoUGxhbiA9IGZhbHNlOwogICAgICB0aGlzLnNob3dQbGFuTGlzdCA9IHRydWU7CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["historyplan.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsDA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"historyplan.vue","sourceRoot":"src/components/testplan","sourcesContent":["<template>\n  <div>\n    <div v-show=\"showPlanList\">\n      <a-page-header\n        title=\"历史计划\"\n        @back=\"() => this.$emit('closeHistory')\"\n      />\n      <a-list\n        class=\"demo-loadmore-list\"\n        :loading=\"loading\"\n        item-layout=\"horizontal\"\n        :data-source=\"data\"\n      >\n        <div\n          v-if=\"showLoadingMore\"\n          slot=\"loadMore\"\n          :style=\"{\n            textAlign: 'center',\n            marginTop: '12px',\n            height: '32px',\n            lineHeight: '32px'\n          }\"\n        >\n          <a-spin v-if=\"loadingMore\" />\n          <a-button v-else @click=\"getPlanData()\">\n            loading more\n          </a-button>\n        </div>\n        <a-list-item slot=\"renderItem\" slot-scope=\"item\">\n          <a slot=\"actions\" @click=\"clickPlanDetail(item)\">查看详情</a>\n          <a slot=\"actions\" @click=\"showDeleteConfirm(item)\">删除计划</a>\n          <a-list-item-meta :description=\"planDetailContent(item)\">\n            <a slot=\"title\" href=\"https://www.antdv.com/\"\n              >版本: {{ item.clientVersion }}</a\n            >\n            <iconfont\n              style=\"font-size:30px\"\n              slot=\"avatar\"\n              iconType=\"icon-plan1\"\n            ></iconfont>\n          </a-list-item-meta>\n          <!-- <div>创建人: {{ item.planUser }}</div> -->\n        </a-list-item>\n      </a-list>\n    </div>\n\n    <eachhistoryplan\n      v-show=\"showEachPlan\"\n      ref=\"eachhistoryplan\"\n      @closeHistoryDetail=\"reShowPlanList\"\n    ></eachhistoryplan>\n  </div>\n</template>\n<script>\nimport request from \"@/utils/request\";\nimport { message, Modal } from \"ant-design-vue\";\nimport iconfont from \"@/components/modulelist/iconfont\";\nimport eachhistoryplan from \"@/components/testplan/eachhistoryplan\";\n\nexport default {\n  data() {\n    return {\n      loading: false,\n      loadingMore: false,\n      showLoadingMore: true,\n      data: [],\n      baseUrl: \"/api/plan/historyplan?pageid=\",\n      pageIndex: 1,\n      showPlanList: true,\n      showEachPlan: false\n    };\n  },\n  created() {\n    this.getPlanData();\n  },\n  watch: {},\n  components: {\n    iconfont,\n    eachhistoryplan\n  },\n  methods: {\n    getPlanData() {\n      this.loadingMore = true;\n      const total_req = this.baseUrl + this.pageIndex;\n      request({\n        url: total_req,\n        method: \"GET\"\n      }).then(res => {\n        if (res.data.code === 340000) {\n          this.data = [...this.data, ...res.data.data.data];\n          console.log(this.data);\n          if (this.pageIndex >= res.data.data.totolPage) {\n            this.showLoadingMore = false;\n          }\n        } else {\n          message.warning(res.data.msg);\n        }\n        this.pageIndex += 1;\n        this.loadingMore = false;\n      });\n    },\n\n    planDetailContent(record) {\n      return (\n        \"接口覆盖率：\" + record.coreRate + \"；计划创建人：\" + record.planUser\n      );\n      //   return \"开始时间：\" + record.planStart + \"；结束时间：\"+ record.planEnd + \"；覆盖率：\" + record.coreRate;\n    },\n\n    handleDeleteOk(record) {\n      console.log(record);\n      request({\n        url: \"/api/plan/deletehistoryplan\",\n        method: \"POST\",\n        data: { id: record.id }\n      }).then(res => {\n        if (res.data.code === 350000) {\n          message.success(res.data.msg);\n          /**\n           * 删除成功后，将数据重置\n           */\n          this.pageIndex = 1;\n          this.data = [];\n          this.showLoadingMore = true;\n          this.getPlanData();\n        } else {\n          message.warning(res.data.msg);\n        }\n      });\n    },\n    showDeleteConfirm(record) {\n      this.selectCoreData = record;\n      const that = this;\n      Modal.confirm({\n        title: \"确认要删除此接口么？(删除之后不可恢复)\",\n        content:\n          \"版本: \" + record.clientVersion + \"; 创建人: \" + record.planUser,\n        okText: \"确认\",\n        okType: \"danger\",\n        cancelText: \"取消\",\n        onOk() {\n          that.handleDeleteOk(record);\n        },\n        onCancel() {\n          console.log(\"Cancel\");\n        }\n      });\n    },\n    clickPlanDetail(record) {\n      console.log(record.id);\n      this.$refs.eachhistoryplan.getPlanId(record);\n      this.showPlanList = false;\n      this.showEachPlan = true;\n    },\n    reShowPlanList() {\n      this.showEachPlan = false;\n      this.showPlanList = true;\n    }\n  }\n};\n</script>\n<style>\n.demo-loadmore-list {\n  min-height: 350px;\n}\n</style>\n"]}]}