{"remainingRequest":"/Users/shenxh/Desktop/qa_auto_test/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/shenxh/Desktop/qa_auto_test/src/components/modulelist/createmitm.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/shenxh/Desktop/qa_auto_test/src/components/modulelist/createmitm.vue","mtime":1612772235218},{"path":"/Users/shenxh/Desktop/qa_auto_test/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/shenxh/Desktop/qa_auto_test/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/shenxh/Desktop/qa_auto_test/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/shenxh/Desktop/qa_auto_test/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1lc3NhZ2UgfSBmcm9tICJhbnQtZGVzaWduLXZ1ZSI7CmltcG9ydCByZXF1ZXN0IGZyb20gIkAvdXRpbHMvcmVxdWVzdCI7CmltcG9ydCB7IGxpbWl0SG9zdExpc3QgfSBmcm9tICJAL3V0aWxzL2NvbW1vbmNvbmZpZyI7Cgpjb25zb2xlLmxvZygiY3JlYXRlbWl0bSIpOwpjb25zb2xlLmxvZyhsaW1pdEhvc3RMaXN0KTsKCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZm9ybUl0ZW1MYXlvdXQ6IHsKICAgICAgICBsYWJlbENvbDogewogICAgICAgICAgeHM6IHsgc3BhbjogMjQgfSwKICAgICAgICAgIHNtOiB7IHNwYW46IDggfQogICAgICAgIH0sCiAgICAgICAgd3JhcHBlckNvbDogewogICAgICAgICAgeHM6IHsgc3BhbjogMjQgfSwKICAgICAgICAgIHNtOiB7IHNwYW46IDE2IH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIGNvbmZpZzogewogICAgICAgIHJ1bGVzOiBbCiAgICAgICAgICB7IHR5cGU6ICJvYmplY3QiLCByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIuivt+mAieaLqeS4gOS4quS7o+eQhuacieaViOaXtumXtCIgfQogICAgICAgIF0KICAgICAgfSwKICAgICAgc2hvd1NwaW46IGZhbHNlLAogICAgICBsaW1pdEhvc3RMaXN0OiBsaW1pdEhvc3RMaXN0CiAgICB9OwogIH0sCiAgYmVmb3JlQ3JlYXRlKCkgewogICAgdGhpcy5mb3JtID0gdGhpcy4kZm9ybS5jcmVhdGVGb3JtKHRoaXMsIHsgbmFtZTogInRpbWVfcmVsYXRlZF9jb250cm9scyIgfSk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBoYW5kbGVTdWJtaXQoZSkgewogICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIHRoaXMuZm9ybS52YWxpZGF0ZUZpZWxkcygoZXJyLCBmaWVsZHNWYWx1ZSkgPT4gewogICAgICAgIGlmIChlcnIpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdGhpcy5zaG93U3BpbiA9IHRydWU7CiAgICAgICAgY29uc3QgdmFsdWVzID0gewogICAgICAgICAgLi4uZmllbGRzVmFsdWUsCiAgICAgICAgICBob3N0X2xpc3Q6IGZpZWxkc1ZhbHVlWyJzZWxlY3QtbXVsdGlwbGUiXS50b1N0cmluZygpLAogICAgICAgICAgcG9ydDogZmllbGRzVmFsdWVbImlucHV0LXBvcnQiXSwKICAgICAgICAgIGV4cGlyZV90aW1lOiBmaWVsZHNWYWx1ZVsiZGF0ZS10aW1lLXBpY2tlciJdLmZvcm1hdCgKICAgICAgICAgICAgIllZWVktTU0tREQgSEg6bW06c3MiCiAgICAgICAgICApCiAgICAgICAgfTsKICAgICAgICBjb25zb2xlLmxvZyhmaWVsZHNWYWx1ZVsiZGF0ZS10aW1lLXBpY2tlciJdKTsKICAgICAgICBjb25zb2xlLmxvZygiUmVjZWl2ZWQgdmFsdWVzIG9mIGZvcm06ICIsIHZhbHVlcyk7CiAgICAgICAgcmVxdWVzdCh7CiAgICAgICAgICB1cmw6ICIvYXBpL3RlbXBpbnRlci9jcmVhdGVtaXRtIiwKICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgICAgZGF0YTogdmFsdWVzCiAgICAgICAgfSkudGhlbihyZXMgPT4gewogICAgICAgICAgaWYgKHJlcy5kYXRhLmNvZGUgPT09IDIxMDAwMikgewogICAgICAgICAgICBtZXNzYWdlLnN1Y2Nlc3MocmVzLmRhdGEubXNnKTsKICAgICAgICAgIH0gZWxzZSBpZiAocmVzLmRhdGEuY29kZSA9PT0gMjEwMDAzKSB7CiAgICAgICAgICAgIG1lc3NhZ2Uud2FybmluZyhyZXMuZGF0YS5tc2cpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbWVzc2FnZS5lcnJvcigi5pyq55+l6ZSZ6K+v77yM5pyN5Yqh56uv5Y+R55Sf5byC5bi4Iik7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCh7IHR5cGU6ICJnZXRVc2VyTWl0bXByb3h5IiB9KS50aGVuKCgpID0+IHsKICAgICAgICAgICAgY29uc29sZS5sb2coIui1sOi/memHjOS5iCIpOwogICAgICAgICAgICB0aGlzLnNob3dTcGluID0gZmFsc2U7CiAgICAgICAgICAgIHRoaXMuJGVtaXQoImNyZWF0ZS1ldmVudCIsIHJlcy5kYXRhLmRhdGEpOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIG9uQ2hhbmdlKGUpIHsKICAgICAgY29uc29sZS5sb2coIui1sOeahOi/memHjO+8n++8n++8nyIpOwogICAgICBjb25zb2xlLmxvZyhlKTsKICAgIH0sCiAgICBjbGlja1RvSW5zdHJ1Y3Rpb24oKSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvaW50ZXJmYWNlL2luc3RydWN0aW9uIik7CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["createmitm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2FA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"createmitm.vue","sourceRoot":"src/components/modulelist","sourcesContent":["<template>\n  <a-spin :spinning=\"showSpin\">\n    <div class=\"total-rouad\">\n      <a-form\n        v-bind=\"formItemLayout\"\n        :form=\"form\"\n        @submit=\"handleSubmit\"\n        style=\"width:calc(60%);float:left;\"\n      >\n        <a-form-item class=\"label-select\">\n          <H4>创建mitmproxy代理</H4>\n        </a-form-item>\n        <a-form-item label=\"代理Port\" class=\"host-select\">\n          <a-input\n            placeholder=\"输入创建代理端口号，如8808\"\n            allow-clear\n            @change=\"onChange\"\n            v-decorator=\"[\n              'input-port',\n              {\n                rules: [\n                  {\n                    required: true,\n                    message: '请输入要创建mitmproxy的端口号',\n                    type: 'string'\n                  }\n                ]\n              }\n            ]\"\n          />\n        </a-form-item>\n\n        <a-form-item label=\"筛选host\" class=\"host-select\">\n          <a-select\n            v-decorator=\"[\n              'select-multiple',\n              {\n                rules: [\n                  {\n                    required: true,\n                    message: '请选择接口所属业务线',\n                    type: 'array'\n                  }\n                ]\n              }\n            ]\"\n            mode=\"multiple\"\n            placeholder=\"请选择要筛选的host\"\n          >\n            <a-select-option\n              v-for=\"(item, index) in limitHostList\"\n              :key=\"index\"\n              :value=\"item\"\n            >\n              {{ item }}\n            </a-select-option>\n          </a-select>\n        </a-form-item>\n        <a-form-item label=\"代理时间\" class=\"host-select\">\n          <a-date-picker\n            v-decorator=\"['date-time-picker', config]\"\n            show-time\n            format=\"YYYY-MM-DD HH:mm:ss\"\n          />\n        </a-form-item>\n        <a-form-item\n          :wrapper-col=\"{\n            xs: { span: 24, offset: 0 },\n            sm: { span: 16, offset: 8 }\n          }\"\n          class=\"host-select\"\n        >\n          <a-button type=\"primary\" html-type=\"submit\">\n            创建\n          </a-button>\n        </a-form-item>\n      </a-form>\n      <div style=\"width:calc(40%);float:left;\">\n        <a-card title=\"创建说明\" style=\"width: 300px\">\n          <a slot=\"extra\" @click=\"clickToInstruction()\">更多</a>\n          <p>1、使用mitmproxy需要先创建一个属于自己的端口号来监听流量</p>\n          <p>2、目前支持筛选指定host的流量，如api.zhihu.com</p>\n          <p>\n            3、使用代理结束后，可以主动销毁mitmproxy，系统也会根据有效时间定时销毁\n          </p>\n        </a-card>\n      </div>\n    </div>\n  </a-spin>\n</template>\n<script>\nimport { message } from \"ant-design-vue\";\nimport request from \"@/utils/request\";\nimport { limitHostList } from \"@/utils/commonconfig\";\n\nconsole.log(\"createmitm\");\nconsole.log(limitHostList);\n\nexport default {\n  data() {\n    return {\n      formItemLayout: {\n        labelCol: {\n          xs: { span: 24 },\n          sm: { span: 8 }\n        },\n        wrapperCol: {\n          xs: { span: 24 },\n          sm: { span: 16 }\n        }\n      },\n      config: {\n        rules: [\n          { type: \"object\", required: true, message: \"请选择一个代理有效时间\" }\n        ]\n      },\n      showSpin: false,\n      limitHostList: limitHostList\n    };\n  },\n  beforeCreate() {\n    this.form = this.$form.createForm(this, { name: \"time_related_controls\" });\n  },\n  methods: {\n    handleSubmit(e) {\n      e.preventDefault();\n      this.form.validateFields((err, fieldsValue) => {\n        if (err) {\n          return;\n        }\n        this.showSpin = true;\n        const values = {\n          ...fieldsValue,\n          host_list: fieldsValue[\"select-multiple\"].toString(),\n          port: fieldsValue[\"input-port\"],\n          expire_time: fieldsValue[\"date-time-picker\"].format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          )\n        };\n        console.log(fieldsValue[\"date-time-picker\"]);\n        console.log(\"Received values of form: \", values);\n        request({\n          url: \"/api/tempinter/createmitm\",\n          method: \"POST\",\n          data: values\n        }).then(res => {\n          if (res.data.code === 210002) {\n            message.success(res.data.msg);\n          } else if (res.data.code === 210003) {\n            message.warning(res.data.msg);\n          } else {\n            message.error(\"未知错误，服务端发生异常\");\n          }\n          this.$store.dispatch({ type: \"getUserMitmproxy\" }).then(() => {\n            console.log(\"走这里么\");\n            this.showSpin = false;\n            this.$emit(\"create-event\", res.data.data);\n          });\n        });\n      });\n    },\n    onChange(e) {\n      console.log(\"走的这里？？？\");\n      console.log(e);\n    },\n    clickToInstruction() {\n      this.$router.push(\"/interface/instruction\");\n    }\n  }\n};\n</script>\n\n<style scoped>\n@media (min-width: 900px) {\n  .host-select {\n    width: calc(60%);\n  }\n  .label-select {\n    margin-left: calc(10%);\n  }\n}\n\n@media (max-width: 900px) {\n  .host-select {\n    width: calc(70%);\n  }\n}\n\n.total-rouad {\n  display: inline;\n}\n\n.example {\n  text-align: center;\n  background: rgba(0, 0, 0, 0.05);\n  border-radius: 4px;\n  margin-bottom: 20px;\n  padding: 30px 50px;\n  margin: 20px 0;\n}\n</style>\n"]}]}