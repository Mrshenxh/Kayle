{"remainingRequest":"/Users/shenxh/Desktop/qa_auto_test/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/shenxh/Desktop/qa_auto_test/src/components/testplan/historyplan.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/Users/shenxh/Desktop/qa_auto_test/src/components/testplan/historyplan.vue","mtime":1611912960092},{"path":"/Users/shenxh/Desktop/qa_auto_test/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/shenxh/Desktop/qa_auto_test/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/shenxh/Desktop/qa_auto_test/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/shenxh/Desktop/qa_auto_test/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/shenxh/Desktop/qa_auto_test/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmRlbW8tbG9hZG1vcmUtbGlzdCB7CiAgbWluLWhlaWdodDogMzUwcHg7Cn0K"},{"version":3,"sources":["historyplan.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkKA;AACA;AACA","file":"historyplan.vue","sourceRoot":"src/components/testplan","sourcesContent":["<template>\n  <div>\n    <div v-show=\"showPlanList\">\n      <a-page-header\n        title=\"历史计划\"\n        @back=\"() => this.$emit('closeHistory')\"\n      />\n      <a-list\n        class=\"demo-loadmore-list\"\n        :loading=\"loading\"\n        item-layout=\"horizontal\"\n        :data-source=\"data\"\n      >\n        <div\n          v-if=\"showLoadingMore\"\n          slot=\"loadMore\"\n          :style=\"{\n            textAlign: 'center',\n            marginTop: '12px',\n            height: '32px',\n            lineHeight: '32px'\n          }\"\n        >\n          <a-spin v-if=\"loadingMore\" />\n          <a-button v-else @click=\"getPlanData()\">\n            loading more\n          </a-button>\n        </div>\n        <a-list-item slot=\"renderItem\" slot-scope=\"item\">\n          <a slot=\"actions\" @click=\"clickPlanDetail(item)\">查看详情</a>\n          <a slot=\"actions\" @click=\"showDeleteConfirm(item)\">删除计划</a>\n          <a-list-item-meta :description=\"planDetailContent(item)\">\n            <a slot=\"title\" href=\"https://www.antdv.com/\"\n              >版本: {{ item.clientVersion }}</a\n            >\n            <iconfont\n              style=\"font-size:30px\"\n              slot=\"avatar\"\n              iconType=\"icon-plan1\"\n            ></iconfont>\n          </a-list-item-meta>\n          <!-- <div>创建人: {{ item.planUser }}</div> -->\n        </a-list-item>\n      </a-list>\n    </div>\n\n    <eachhistoryplan\n      v-show=\"showEachPlan\"\n      ref=\"eachhistoryplan\"\n      @closeHistoryDetail=\"reShowPlanList\"\n    ></eachhistoryplan>\n  </div>\n</template>\n<script>\nimport request from \"@/utils/request\";\nimport { message, Modal } from \"ant-design-vue\";\nimport iconfont from \"@/components/modulelist/iconfont\";\nimport eachhistoryplan from \"@/components/testplan/eachhistoryplan\";\n\nexport default {\n  data() {\n    return {\n      loading: false,\n      loadingMore: false,\n      showLoadingMore: true,\n      data: [],\n      baseUrl: \"/api/plan/historyplan?pageid=\",\n      pageIndex: 1,\n      showPlanList: true,\n      showEachPlan: false\n    };\n  },\n  created() {\n    this.getPlanData();\n  },\n  watch: {},\n  components: {\n    iconfont,\n    eachhistoryplan\n  },\n  methods: {\n    getPlanData() {\n      this.loadingMore = true;\n      const total_req = this.baseUrl + this.pageIndex;\n      request({\n        url: total_req,\n        method: \"GET\"\n      }).then(res => {\n        if (res.data.code === 340000) {\n          this.data = [...this.data, ...res.data.data.data];\n          console.log(this.data);\n          if (this.pageIndex >= res.data.data.totolPage) {\n            this.showLoadingMore = false;\n          }\n        } else {\n          message.warning(res.data.msg);\n        }\n        this.pageIndex += 1;\n        this.loadingMore = false;\n      });\n    },\n\n    planDetailContent(record) {\n      return (\n        \"接口覆盖率：\" + record.coreRate + \"；计划创建人：\" + record.planUser\n      );\n      //   return \"开始时间：\" + record.planStart + \"；结束时间：\"+ record.planEnd + \"；覆盖率：\" + record.coreRate;\n    },\n\n    handleDeleteOk(record) {\n      console.log(record);\n      request({\n        url: \"/api/plan/deletehistoryplan\",\n        method: \"POST\",\n        data: { id: record.id }\n      }).then(res => {\n        if (res.data.code === 350000) {\n          message.success(res.data.msg);\n          /**\n           * 删除成功后，将数据重置\n           */\n          this.pageIndex = 1;\n          this.data = [];\n          this.showLoadingMore = true;\n          this.getPlanData();\n        } else {\n          message.warning(res.data.msg);\n        }\n      });\n    },\n    showDeleteConfirm(record) {\n      this.selectCoreData = record;\n      const that = this;\n      Modal.confirm({\n        title: \"确认要删除此接口么？(删除之后不可恢复)\",\n        content:\n          \"版本: \" + record.clientVersion + \"; 创建人: \" + record.planUser,\n        okText: \"确认\",\n        okType: \"danger\",\n        cancelText: \"取消\",\n        onOk() {\n          that.handleDeleteOk(record);\n        },\n        onCancel() {\n          console.log(\"Cancel\");\n        }\n      });\n    },\n    clickPlanDetail(record) {\n      console.log(record.id);\n      this.$refs.eachhistoryplan.getPlanId(record);\n      this.showPlanList = false;\n      this.showEachPlan = true;\n    },\n    reShowPlanList() {\n      this.showEachPlan = false;\n      this.showPlanList = true;\n    }\n  }\n};\n</script>\n<style>\n.demo-loadmore-list {\n  min-height: 350px;\n}\n</style>\n"]}]}